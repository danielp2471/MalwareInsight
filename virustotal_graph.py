import json
import matplotlib.pyplot as plt

# Load JSON data from file
json_data_file = 'reports/virustotal_results.txt'
with open(json_data_file, 'r') as file:
    json_data = json.load(file)

# Extract necessary data
stats = json_data["data"]["attributes"]["stats"]

# Define colors for specific categories
category_colors = {
    "type-unsupported": 'purple',
    "harmless": 'green',
    "undetected": 'grey',
    "malicious": 'red',
    "suspicious": 'orange',
    "confirmed-timeout": 'blue',
    "timeout": 'pink',
    "failure": 'yellow',

}

# Create data for the pie chart
labels = list(stats.keys())
sizes = [stats[label] for label in labels]

# Generate a list of colors based on the defined colors for each category
colors = [category_colors[label] for label in labels]

# Plot the pie chart with the specified colors
plt.pie(sizes, labels=labels, colors=colors, autopct='%1.1f%%', shadow=True)
plt.axis('equal')
plt.title('Distribution of Categories')

# Save the pie chart image
chart_image = 'reports/AVStat_PieChart.png'
plt.savefig(chart_image)
plt.close()
