import csv

input_csv_file = r'.\monitor_report.csv'
output_registry_file = r'.\report_registry_events.csv'
output_file_system_events = r'.\report_file_system_events.csv'

registry_operations = ['RegQueryValue', 'RegSetValue', 'RegDeleteValue', 'RegCreateKey', 'RegDeleteKey', 'RegEnumValue', 'RegEnumKey']

with open(input_csv_file, 'r', newline='', encoding='utf-8') as input_file, \
        open(output_registry_file, 'w', newline='', encoding='utf-8-sig') as output_registry:
    input_reader = csv.reader(input_file)
    output_writer = csv.writer(output_registry)

    # Write the header row to the output registry file
    header_row = next(input_reader)
    output_writer.writerow(header_row)

    # Write only the registry operations to the output registry file
    for row in input_reader:
        if any(operation in row[3] for operation in registry_operations):
            output_writer.writerow(row)

print("Registry events report generated successfully.")

file_system_operations = ['ReadFile', 'WriteFile', 'QueryInformationFile', 'SetInformationFile', 'CreateFile',
                          'DeleteFile', 'Rename', 'OpenFile', 'CloseFile', 'FlushBuffersFile', 'DirectoryEnumeration']

with open(input_csv_file, 'r', newline='', encoding='utf-8') as input_file, \
        open(output_file_system_events, 'w', newline='', encoding='utf-8-sig') as output_file_system:
    input_reader = csv.reader(input_file)
    output_writer = csv.writer(output_file_system)

    # Write the header row to the output file system events file
    output_writer.writerow(header_row)

    # Write only the file system operations to the output file system events file
    for row in input_reader:
        if any(operation in row[3] for operation in file_system_operations):
            output_writer.writerow(row)

print("File system events report generated successfully.")
