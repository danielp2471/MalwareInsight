import matplotlib.pyplot as plt

def plot_registry_operations(event_counts):
    # Extract the keys (event types) and their counts
    events = list(event_counts.keys())
    counts = list(event_counts.values())
    
    # Create a bar chart
    plt.figure(figsize=(10,6))
    plt.barh(events, counts, color='skyblue')
    plt.xlabel('Count')
    plt.ylabel('Registry Operation')
    plt.title('Registry Operations Count')
    plt.gca().invert_yaxis()  # This will show the event with the highest count on top
    plt.tight_layout()
    
    # Save the chart as an image
    registry_operations_image_path = r'reports\registry_operations.png'
    plt.savefig(registry_operations_image_path)
    # Optionally display the chart
    #plt.show()
    plt.close()

    return registry_operations_image_path


